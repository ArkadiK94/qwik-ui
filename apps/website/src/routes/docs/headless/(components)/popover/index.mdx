---
title: Qwik UI | Popover
---

import {
  StatusBanner,
  ShowExample,
  CodeExample,
  AnatomyTable,
  statusByComponent,
  KeyboardInteractionTable,
  APITable,
} from './exports';

<StatusBanner status={statusByComponent.headless.Popover}/> 

# Popover

A non-modal primitive with overlays that open and close around a DOM element.

<ShowExample example="hero" />

The Qwik UI Popover component is designed to align with the [HTML Popover API Specification](https://developer.mozilla.org/en-US/docs/Web/API/Popover_API). As of now, native support for this API is around `63%`. To ensure consistent behavior across all browsers, Qwik UI provides a `polyfill` for browsers that do not support the API natively.

## What is a Popover?

A popover is a **non-modal** UI element that creates overlays around a DOM element. Non-modal meaning the rest of the page can be interacted with while the popover is shown.

This is particularly useful for displaying additional information or options without navigating away from the current context. It is also a **native replacement for [portals](https://qwik.builder.io/docs/cookbook/portal/#portal)**, which are commonly used in other JavaScript frameworks. 

<ShowExample example="inspect" />

> An example use case for a popover, is preventing overflow issues within your UI. The popover API guarantees that your content remains above the rest of the page.

Most importantly, this API is a foundation for other headless components. Qwik UI is one of the first *(if not the first)* headless libraries to align with the specification. The content inside of Qwik UI popovers are also natively resumable.

## Versatile use cases <span class="ml-2 text-red-400 dark:text-red-400 text-base px-2 bg-red-100 rounded-md shadow-light-low dark:shadow-dark-medium border-b-2 border-[1px] border-red-200 dark:border-red-300">WIP</span>

Here are a couple of example components where the Popover API can be used. Including other parts of Qwik UI headless. Throughout the documentation, we will show the Combobox being used as an example.

 <AnatomyTable
  propDescriptors={[
    {
      name: 'Combobox',
      description: 'A text input that allows users to fill in values from a predefined list.',
    },
    {
      name: 'Select',
      description: 'A dropdown menu that allows users to choose one value from a list.',
    },
    {
      name: 'Context Menu',
      description: 'A menu that appears upon user interaction, such as right-clicking.',
    },
    {
      name: 'Tooltip',
      description: 'A text label that appears when a user hovers, focuses, or touches an element.',
    },
    {
      name: 'Toast',
      description: 'A small message that shows up temporarily to give the user some feedback.',
    },
    {
      name: 'Dropdown Menu',
      description: 'A list of options that appears below a button, that users can select from.',
    },
    {
      name: 'Hover Card',
      description: 'A card that appears when a user hovers over an element.',
    },
    {
      name: 'Menubar',
      description: 'A horizontal menu with clickable items.',
    },
  ]}
/>

## Caveats


### Psuedo Selectors
In the context of a native popover, the `:popover-open` pseudo selector is used when the popover is in the open state. However, pseudo selectors can't be polyfilled within CSS. So, the polyfill adds the `.popover-open` CSS class to any open popover instead. This means an open popover will have `class=":popover-open"`.

In JavaScript, both the pseudoselector and class can be used to select the same element, thanks to the polyfill. The matches and closest methods are also patched to work with `:popover-open`. Below is an example of both scenarios.

<ShowExample example="matches" />

In environments that don't support the native popover, using `:popover-open` in CSS will be invalid and ignored. If you want to style a popover using .popover-open, it must be a separate declaration. Combining selectors like `[popover]:popover-open` or `[popover].popover-open` won't work.

### Native Invokers

For **native invokers** (buttons using the popovertarget attribute) on `popover=auto`, the polyfill sets the `aria-expanded` attribute to render them in the accessibility tree as elements with expanded.

## Popovertarget

To add a popover trigger, it can be done exactly like the native API, using the `popovertarget` attribute along with the corresponding popover id. This includes being used on **native button elements**, but it can be leveraged as a prop as well.

<CodeExample>
  ```tsx
  // Opens when trigger is clicked, with a matching id to popovertarget

  <button popovertarget="get-20-off">Get 20% off your next order!</button>

  // Note: can be used to trigger popups anywhere in the component tree!
  ```
</CodeExample>

## The popover attribute

A popover can be set to either `auto` (the default setting) or `manual`. What we've seen so far have been **auto** popovers.

Qwik UI adds the popover attribute for you under the hood.

<CodeExample>
  ```tsx
  // Qwik UI
  <Popover id="my-id">"Auto vs Manual Popovers: A Qwik Guide to Playing Hide and Seek!"</Popover>

  // Native API:  Adding popover here is the same as popover="auto"
  <div id="my-id" popover>"Auto vs Manual Popovers: A Qwik Guide to Playing Hide and Seek!"</div>
  ```
</CodeExample>


### Auto

<ShowExample example="auto" />

An auto popover will automatically hide when you click outside of it and typically only one can be shown at a time. 

### Manual

<ShowExample example="manual" />

On the other hand, a `manual` popover needs to be manually hidden, such as toggling the button or programmatically, and allows for scenarios like nested popovers in menus.

### Popover Methods

There are two methods for showing and hiding popovers manually in JavaScript. The `showPopover` and `hidePopover` methods. For example, here is programmatic behavior syncing the popover state with the listbox in the `Combobox` component.

<CodeExample>
  ```tsx
  useTask$(function syncPopoverStateTask({ track }) {
    track(() => context.isListboxOpenSig.value);

    if (!context.popoverRef.value) {
      return;
    }

    context.isListboxOpenSig.value
      ? context.popoverRef.value.showPopover()
      : context.popoverRef.value.hidePopover();
  });
  ```
</CodeExample>

## Floating Behavior

To use the popover API with floating elements, you can add the `floating={true}` prop to the Popover component. This API enables the use of JavaScript to dynamically position the listbox using the `top` & `left` absolute properties.

To float an element, it must have an anchored element to latch onto. This can be done with the `anchorRef` prop.

### AnchorRef Prop

<ShowExample example="anchorRef" />

### Floating Prop

This API is purposely opt-in / incremental. At some point JavaScript will not be needed here thanks to the CSS Anchor API that is currently experimental.

We chose not to use an Anchor polyfill here due to the difference in bundle size compared to a JavaScript implementation.

## **Configuring the Listbox**

The `Popover` component is designed for positioning elements that float and facilitating interactions with them.

For the following examples, we'll be using the Combobox component. `ComboboxPopover` is merely a wrapper of the Popover component. Under the hood, it looks something like this:

<CodeExample>
  ```tsx
    <Popover
      {...props}
      manual
      id={popoverId}
      floating={true}
      // passing in a custom ref for programmatic behavior
      anchorRef={context.inputRef}
      popoverRef={context.popoverRef}
      behavior="listbox"
    >
      <Slot />
    </Popover>
  ```
</CodeExample>

### Placement

To set the default position of the listbox, you can use the `placement` prop. In the example below, we've set placement to top. When the user opens the listbox, it will be above the input.

<ShowExample example="placement" />

The default placement is **bottom**.

### Flip

Allows the listbox to flip its position based on available space. It's enabled by default, but can be disabled by adding `flip={false}` on the listbox.

<ShowExample example="flip" />

### Gutter
  
In the previous docs examples, we use the gutter property on the listbox. Gutter is the space between the input and the floating element.

<ShowExample example="gutter" />

If Flip is enabled, it will provide a gutter space for both the top and bottom.

## Styling

Styles can be added normally like any other component in Qwik UI, such as adding a class. The Popover API however, exposes the `[popover]` and `:popover-open` attribute and pseudo-class selectors which can be used to style both the open and closed states.

From an earlier section, we learned that the `:popover-open` psuedo-class cannot be polyfilled, and so a class is added instead.

<CodeExample>
  ```tsx
  [popover] {
  /* Make the popover a grid */
  display: grid;
  }

  [popover]:not(:popover-open) {
    /* Make sure to hide it unless open */
    display: none;
  }

  /* Duplicate for polyfill browsers */
  [popover]:not(.\:popover-open) {
    display: none;
  }
  ```
</CodeExample>

If Tailwind is the framework of choice, then styles can be added using the [arbitrary variant syntax](https://tailwindcss.com/docs/hover-focus-and-other-states#using-arbitrary-variants) or [@apply](https://tailwindcss.com/docs/reusing-styles#extracting-classes-with-apply) command. Below is an example of styling with `[popover]` as an arbitrary variant.

<ShowExample example="styling" />

> The arbitrary variant can be customized/abstracted even further by [adding a variant](https://tailwindcss.com/docs/plugins#adding-variants) as a plugin in the tailwind config.


## Backdrops

<ShowExample example="backdrop" />

## Animations

### The problem

Currently, native animation support for the popover API is [not quite there yet](https://open-ui.org/components/popover.research.explainer/#animation-of-popovers). Part of this has to do with the native API managing the popover state and adding the `display: none` declaration. This declaration is `unanimatable`, meaning you cannot animate to or from display none at this time. With that said, we currently have a way to animate popovers using a clever trick under the hood.

### Custom animation support

Regardless of native support, animations need support in polyfill browsers too, and so we've provided a way for you to use both `animation` and `transition` declarations in your `Popover` component for **all browsers**.

### Animation declarations

<ShowExample example="animationListbox" />

To use an animation declaration, add the `animation` prop on the popover along with an `entryAnimation` and `exitAnimation`.

- The `entryAnimation` prop determines what class is added when the listbox is **opened**.

- The `exitAnimation` prop determines what class is added when the listbox is **closed**.

Here's the CSS imported from the example:
<CodeExample>
  ```css
  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes fadeOut {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

.animate-in {
  animation: fadeIn both 500ms ease;
}

.animate-out {
  animation: fadeOut both 500ms ease;
}

  ```
</CodeExample>

> entryAnimation & exitAnimation props also apply to transition declarations as well. Below is an example of that use case.

### Transition declarations

<ShowExample example="animation" />

Transitions use the same props as the animation declaration when it comes to entry and exit animation classes. Those being `entryAnimation` and `exitAnimation`.

In order to use a transition, add the `transition` prop on the popover.

> The [View Transitions API](https://developer.mozilla.org/en-US/docs/Web/API/View_Transitions_API) is another native solution that aims to solve this problem. Support is currently in around **65%** of browsers. 

## Additional References

Qwik UI aims to be in line with the standard whenever possible. Our goal is to give Qwik developers the proper tooling when it comes to creating accessible & complex web applications.

To read more about the popover API you can check it out on:
- [MDN](https://developer.mozilla.org/en-US/docs/Web/API/Popover_API)
- [Open UI Proposal](https://open-ui.org/components/popover.research.explainer/)
- [What is the top layer?](https://developer.chrome.com/blog/what-is-the-top-layer/)

## Additional Examples

### Auto Placement
  
Automatically places the listbox based on available space. **You must set flip to false before using it.**  This comes in handy when you're unsure about the optimal placement for the floating element, or if you prefer not to set it manually.

<ShowExample example="autoPlacement" />

<div class="bg-red-200 dark:bg-red-900 p-4 lg:p-6 rounded-xl dark:border-[#F3F3F3] border-[#333333] shadow-light-medium dark:shadow-dark-medium">
  **NOTE:** You cannot use **flip** and **autoPlacement** at the same time. They both manipulate the placement but with different strategies. Using both can result in a continuous reset loop as they try to override each other's work.
</div>




